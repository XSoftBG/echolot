(function(a){a.addFlex=function(x,z){if(x.grid){return false;}z=a.extend({height:"auto",width:"auto",striped:true,novstripe:false,minwidth:30,minheight:80,resizable:false,url:false,method:"POST",dataType:"xml",errormsg:"Connection Error",usepager:false,nowrap:true,page:1,total:1,useRp:true,rp:15,rpOptions:[10,15,20,25,40],title:false,colModel:false,pagestat:"Displaying {from} to {to} of {total} items",procmsg:"Processing, please wait ...",hidecolmsg:"Hide/Show Columns",mintablemsg:"Minimize/Maximize Table",query:"",qtype:"",nomsg:"No items",pageWord:"Page",ofWord:"of",minColToggle:1,showToggleBtn:true,showPageStat:true,hideOnSubmit:true,autoload:true,blockOpacity:0.5,onToggleCol:false,onChangeSort:false,onSuccess:false,onChangePage:false,onSubmit:false,onPopulateCallback:false,onDragCol:false,onResizeCol:false,onResizeGrid:false,owner:false,debug:false,sortorder:"asc",sortModel:{columns:[]},clientsort:true,digitGroupDL:".",decimalDelimiter:",",heightOffset:100,searchitems:false},z);a(x).show().attr({cellPadding:0,cellSpacing:0,border:0}).removeAttr("width");var H={hset:{},rePosDrag:function(){var s=0-this.hDiv.scrollLeft;if(this.hDiv.scrollLeft>0){s-=Math.floor(z.cgwidth/2);}a(H.cDrag).css({top:H.hDiv.offsetTop+1});var p=this.cdpad;var i=a("div",H.cDrag);i.hide();var g=a("thead tr:first th:visible",this.hDiv);for(var P=0;P<g.length;P++){var t=parseInt(a(g[P]).width());if(s==0){s-=Math.floor(z.cgwidth/2);}t=t+s+p;a(i[P]).css({left:t+"px"}).show();s=t;}},fixHeight:function(i){i=false;if(!i){i=a(H.bDiv).height();}var p=a(this.hDiv).height();a("div",this.cDrag).each(function(){a(this).height(i+p);});a(H.block).css({height:i,marginBottom:(i*-1)});var g=H.bDiv.offsetTop+i;if(z.height!="auto"&&z.resizable){g=H.vDiv.offsetTop;}a(H.rDiv).css({height:g});},dragStart:function(t,s,p){if(t=="colresize"){a(H.nDiv).hide();a(H.nBtn).hide();var P=a("div",this.cDrag).index(p);var g=a("th:visible:eq("+P+")",this.hDiv).width();a(p).addClass("dragging").siblings().hide();a(p).prev().addClass("dragging").show();this.colresize=a.extend(true,{},{startX:s.pageX,ol:parseInt(p.style.left),ow:g,n:P});a("body").css("cursor","col-resize");}else{if(t=="vresize"){var i=false;a("body").css("cursor","row-resize");if(p){i=true;a("body").css("cursor","col-resize");}this.vresize={h:z.height,sy:s.pageY,w:z.width,sx:s.pageX,hgo:i};}else{if(t=="colMove"){a(H.nDiv).hide();a(H.nBtn).hide();this.hset=a(this.hDiv).offset();this.hset.right=this.hset.left+a("table",this.hDiv).width();this.hset.bottom=this.hset.top+a("table",this.hDiv).height();this.dcol=p;this.dcoln=a("th",this.hDiv).index(p);this.colCopy=document.createElement("div");this.colCopy.className="colCopy";this.colCopy.innerHTML=p.innerHTML;if(a.browser.msie){this.colCopy.className="colCopy ie";}a(this.colCopy).css({position:"absolute","float":"left",display:"none",textAlign:p.align});a("body").append(this.colCopy);a(this.cDrag).hide();}}}a(H.gDiv).noSelect();},dragMove:function(t){if(this.colresize){var i=this.colresize.n;var T=t.pageX-this.colresize.startX;var P=this.colresize.ol+T;var s=this.colresize.ow+T;if(s>z.minwidth){a("div:eq("+i+")",this.cDrag).css("left",P);this.colresize.nw=s;}}else{if(this.vresize){var U=this.vresize;var R=t.pageY;var T=R-U.sy;if(!z.defwidth){z.defwidth=z.width;}if(z.width!="auto"&&!z.nohresize&&U.hgo){var S=t.pageX;var p=S-U.sx;var g=U.w+p;if(g>z.defwidth){this.gDiv.style.width=g+"px";z.width=g;}}var Q=U.h+T;if((Q>z.minheight||z.height<z.minheight)&&!U.hgo){this.bDiv.style.height=Q+"px";z.height=Q;this.fixHeight(Q);}U=null;}else{if(this.colCopy){a(this.dcol).addClass("thMove").removeClass("thOver");if(t.pageX>this.hset.right||t.pageX<this.hset.left||t.pageY>this.hset.bottom||t.pageY<this.hset.top){a("body").css("cursor","move");}else{a("body").css("cursor","pointer");}a(this.colCopy).css({top:t.pageY+10,left:t.pageX+20,display:"block"});}}}},dragEnd:function(){if(this.colresize){H.setBusy(true);var s=this.colresize.n;var Q=this.colresize.nw;var P=a("th:visible:eq("+s+")",this.hDiv);P.css("width",Q);P.data("isUserSized",true);var S=a("#"+a.fn.fixID(z.ownerId+".DATA")).children("tr");var g=0;var t=Core.Web.Scheduler.run(Core.method(this,function(){var X=50;while(X-->0&&g<S.length){var W=a(S[g++]).children("td:visible:eq("+s+")");W.css("width",Q);var T=a(":first-child",W[0]);var V=W.attr("title");if(Q<T.width()&&!V){var U=z.owner.component.getComponent(/(\d*)$/.exec(W.attr("id"))[0]*1);W.attr("title",U.get("text"));}else{if(Q>=T.width()&&V){W.removeAttr("title");}}}if(g==S.length){Core.Web.Scheduler.remove(t);H.setBusy(false);}}),1,true);this.hDiv.scrollLeft=this.bDiv.scrollLeft;a("div:eq("+s+")",this.cDrag).siblings().show();a(".dragging",this.cDrag).removeClass("dragging");this.rePosDrag();this.fixHeight();this.colresize=false;if(z.onResizeCol&&z.colModel){var i=z.colModel[s].id;z.onResizeCol.call(z.owner,i,Q);}}else{if(this.vresize){this.vresize=false;if(z.onResizeGrid){z.onResizeGrid.call(z.owner,z.width,z.height);}}else{if(this.colCopy){a(this.colCopy).remove();if(this.dcolt!=null){if(this.dcoln>this.dcolt){a("th:eq("+this.dcolt+")",this.hDiv).before(this.dcol);}else{a("th:eq("+this.dcolt+")",this.hDiv).after(this.dcol);}this.switchCol(this.dcoln,this.dcolt);a(this.cdropleft).remove();a(this.cdropright).remove();this.rePosDrag();if(z.onDragCol&&z.colModel){var p=z.colModel[this.dcoln].id;}var R=z.colModel[this.dcolt].id;z.onDragCol.call(z.owner,p,R);}this.dcol=null;this.hset=null;this.dcoln=null;this.dcolt=null;this.colCopy=null;a(".thMove",this.hDiv).removeClass("thMove");a(this.cDrag).show();}}}a("body").css("cursor","default");a(H.gDiv).noSelect(false);},toggleCol:function(R,P){var i=a("th[axis='col"+R+"']",this.hDiv)[0];var Q=a("thead th",H.hDiv).index(i);var g=a("input[value="+R+"]",H.nDiv)[0];if(P==null){P=i.hide;}if(a("input:checked",H.nDiv).length<z.minColToggle&&!P){return false;}if(P){i.hide=false;a(i).show();g.checked=true;}else{i.hide=true;a(i).hide();g.checked=false;}var t=a("#"+a.fn.fixID(z.ownerId+".DATA"));var s=t.children("tr");s.each(function(){a(this).children("td:eq("+Q+")").toggle();});this.rePosDrag();if(z.onToggleCol&&z.colModel){var p=z.colModel[R].id;z.onToggleCol.call(z.owner,p,P);}return P;},switchCol:function(i,g){var s=a("#"+a.fn.fixID(z.ownerId+".DATA"));var p=s.children("tr");p.each(function(){var Q=a(this);var t=Q.children("td:eq("+g+")");var P=Q.children("td:eq("+i+")");if(i>g){t.before(P);}else{t.after(P);}});if(i>g){a("tr:eq("+g+")",this.nDiv).before(a("tr:eq("+i+")",this.nDiv));}else{a("tr:eq("+g+")",this.nDiv).after(a("tr:eq("+i+")",this.nDiv));}if(a.browser.msie&&a.browser.version<7){a("tr:eq("+g+") input",this.nDiv)[0].attr("checked",true);}this.hDiv.scrollLeft=this.bDiv.scrollLeft;},scroll:function(){this.hDiv.scrollLeft=this.bDiv.scrollLeft;this.rePosDrag();},addData:function(T){this.data=T;if(!T){R();return false;}if(z.dataType!="xml"){z.total=T.total;z.page=T.page;}else{z.total=+a("rows total",T).text();z.page=+a("rows page",T).text();}z.pages=z.rp==-1?1:Math.ceil(z.total/z.rp);if(z.total==0){a("tr, a, td, div",x).unbind();a(x).empty();z.pages=1;z.page=1;R();a(".pPageStat",this.pDiv).html(z.nomsg);return false;}if(z.rp==-1&&this.data&&z.clientsort&&z.sortModel&&z.sortModel.columns.length>0){this.multiSort(z.sortModel,new exxcellent.model.ColumnModel(z.colModel),new exxcellent.model.TableModel(new Array(this.data)));}if(z.height=="auto"){var i=a(H.gDiv);var P=i.offsetParent().attr("offsetHeight")-z.heightOffset;a(H.bDiv).css({height:P+"px"});}var t=a("thead tr:first th",H.hDiv);if(!this.dataDOM){var U=document.createElement("tbody");var Y=document.createElement("tr");var S=document.createElement("td");S.appendChild(document.createElement("div"));if(!z.nowrap){S.style.whiteSpace="normal";}for(var Z=0;Z<t.length;Z++){Y.appendChild(S.cloneNode(true));}for(var g=0;g<T.rows.length;g++){U.appendChild(Y.cloneNode(true));}this.dataDOM=U;}else{var X=T.rows.length-this.dataDOM.childNodes.length;if(X>0){while(X-->0){this.dataDOM.appendChild(this.dataDOM.childNodes[0].cloneNode(true));}}else{if(X<0){while(X++<0){this.dataDOM.removeChild(this.dataDOM.childNodes[0]);}}}}var V=this.dataDOM.cloneNode(true);V.id=z.ownerId+".DATA";var p=a(V);function R(){var ab=a(x);a("tr",ab).unbind();ab.empty().append(p);if(T.rows.length!=0){H.rePosDrag();H.fixHeight();}V=null;p=null;T=null;if(z.onSuccess){z.onSuccess.call(z.owner);}H.setBusy(false);if(H.lazyFocus){H.lazyFocus.call(this,true);}H.buildpager();H.notifyForSelection();}if(z.dataType=="json"){var W=0;var aa=null;var s=new Date();var Q=Core.Web.Scheduler.run(Core.method(this,function(){var ae=20;while(T&&T.rows.length>W&&T.rows[W]&&ae>0){aa=T.rows[W];var ad=a(V.childNodes[W]);if(aa.id!==null){ad.attr("id",z.ownerId+".ROW."+aa.id);}if(W%2&&z.striped){ad.addClass("erow");}var ac=t.length;for(var ab=0;ab<ac;ab++){H.addCellProp(V.childNodes[W].childNodes[ab],ad,aa.cells[a(t[ab]).data("rowDataIndex")],t[ab]);}H.addRowProp(ad);W++;ae--;}if(W==T.rows.length){Core.Web.Scheduler.remove(Q);R();console.log("render time: "+(new Date()-s)+"ms");}}),1,true);}else{throw new Error('DataType "'+z.dataType+'" could not be handled.');}},changeSort:function(p,R){if(this.loading){return true;}a(H.nDiv).hide();a(H.nBtn).hide();if(!R){z.sortModel.columns=[];var Z=a("div",p);a("thead tr:first th div",this.hDiv).not(Z).removeClass("sdesc").removeClass("sasc");a(p).siblings().removeClass("sorted");}var W=a("div",p);var t=a(p).hasClass("sorted");var s=new Object();var X=a(p).attr("abbr");var P=a(p,p.parentNode).index();if(t){var Y="";if(z.sortModel.columns.length>0){for(var V=0;V<z.sortModel.columns.length;V++){var S=z.sortModel.columns[V];if(S.columnId==X){S.sortOrder=(a(W).hasClass("sasc")?"asc":"desc");s=S;break;}}}else{s=new Object({columnId:X,columnIdx:P,sortOrder:(a(W).hasClass("sasc")?"asc":"desc")});z.sortModel.columns.push(s);}}else{if(!t){a(p).addClass("sorted");W.addClass("s"+z.sortorder);s=new Object({columnId:X,columnIdx:P,sortOrder:z.sortorder});z.sortModel.columns.push(s);}}if(z.rp!=-1){if(z.onChangeSort){z.onChangeSort.call(z.owner,z.sortModel);}}else{this.setBusy(true);var i=JSON.parse(JSON.stringify(this.data));this.multiSort(z.sortModel,new exxcellent.model.ColumnModel(z.colModel),new exxcellent.model.TableModel(new Array(i)));this.data=i;var U=[];a(z.sortModel.columns).each(function(ac,ab){U.push(ab.columnIdx);});var T=function(ab,ac){if(Core.Arrays.indexOf(U,ab)>=0){a(ac).addClass("sorted");}else{a(ac).removeClass("sorted");}};var aa=a("#"+a.fn.fixID(z.ownerId+".DATA"));var g=0;var Q=Core.Web.Scheduler.run(Core.method(this,function(){var ac=50;while(ac>0&&i.rows.length>g){var ab=a("#"+a.fn.fixID(z.ownerId+".ROW."+i.rows[g].id));ab.children().each(T);if(g%2==0&&z.striped){ab.removeClass("erow");}else{ab.addClass("erow");}aa.append(ab);ac--;g++;}if(g==i.rows.length){Core.Web.Scheduler.remove(Q);H.setBusy(false);if(z.onChangeSort){z.onChangeSort.call(z.owner,z.sortModel);}}}),1,true);}},buildpager:function(){a(".pcontrol input",this.pDiv).val(z.page);a(".pcontrol span",this.pDiv).html(z.pages);var i=(z.page-1)*z.rp+1;var g=z.rp==-1?z.total:i+z.rp-1;if(z.total<g){g=z.total;}var p=z.pagestat;p=p.replace(/{from}/,i);p=p.replace(/{to}/,g);p=p.replace(/{total}/,z.total);a(".pPageStat",this.pDiv).html(p);},setBusy:function(s){var g=false;var p=a(".pPageStat",this.pDiv);if(s){if(!this.loading){this.loading=true;p.data("content",p.html());p.html(z.procmsg);a(".pReload",this.pDiv).addClass("loading");a(H.block).css({top:H.bDiv.offsetTop,position:"absolute",width:H.bDiv.offsetWidth,height:H.bDiv.offsetHeight});if(z.hideOnSubmit){a(this.gDiv).prepend(H.block);}if(a.browser.opera){a(x).css("visibility","hidden");}g=true;}}else{if(this.loading){var i=a(".pPageStat",this.pDiv);if(i.html()==z.procmsg){p.html(p.data("content"));}a(".pReload",this.pDiv).removeClass("loading");if(z.hideOnSubmit){a(H.block).remove();}H.hDiv.scrollLeft=H.bDiv.scrollLeft;if(a.browser.opera){a(x).css("visibility","visible");}this.loading=false;g=true;}}return g;},populate:function(){if(this.loading){return true;}if(z.onSubmit){var g=z.onSubmit();if(!g){return false;}}if(!z.url){return false;}this.setBusy(true);if(!z.newp){z.newp=1;}if(z.page>z.pages){z.page=z.pages;}var s=[{name:"page",value:z.newp},{name:"rp",value:z.rp},{name:"query",value:z.query},{name:"qtype",value:z.qtype}];var i=[];for(E in s){var p=s[E];if(p&&p.name&&p.value){i.push(p);}}i=z.onPopulateCallback.call(z.owner,i);H.addData(i);},doSearch:function(){z.query=a("input[name=q]",H.sDiv).val();z.qtype=a("select[name=qtype]",H.sDiv).val();z.newp=1;this.populate();},changePage:function(i){if(this.loading){return true;}switch(i){case"first":z.newp=1;break;case"prev":if(z.page>1){z.newp=parseInt(z.page)-1;}break;case"next":if(z.page<z.pages){z.newp=parseInt(z.page)+1;}break;case"last":z.newp=z.pages;break;case"input":var g=parseInt(a(".pcontrol input",this.pDiv).val());if(isNaN(g)){g=1;}if(g<1){g=1;}else{if(g>z.pages){g=z.pages;}}a(".pcontrol input",this.pDiv).val(g);z.newp=g;break;}if(z.newp==z.page){return false;}if(z.onChangePage){z.onChangePage.call(z.owner,z.newp);}else{this.populate();}},addCellProp:function(g,p,i,t){var s=a(g);if(t){if(a(t).hasClass("sorted")){s.addClass("sorted");}if(t.hide){s.css("display","none");}}H.renderCell(i.componentIdx,s.children(":first-child")[0],g);},getCellDim:function(p){var Q=parseInt(a(p).height());var g=parseInt(a(p).parent().height());var t=parseInt(p.style.width);var S=parseInt(a(p).parent().width());var P=p.offsetParent.offsetTop;var i=p.offsetParent.offsetLeft;var R=parseInt(a(p).css("paddingLeft"));var s=parseInt(a(p).css("paddingTop"));return{ht:Q,wt:t,top:P,left:i,pdl:R,pdt:s,pht:g,pwt:S};},clearSelection:function(){this.selectedRow=null;a(this.gDiv).noSelect();},processSelection:function(i,s){if(z.selectionMode==0){return;}var p=/(\d*)$/.exec(i.attr("id"))[0]*1;if(z.selectionMode==1){if(s.ctrlKey){if(i.is(".trSelected")){z.nur.push(p);i.toggleClass("trSelected");}else{z.nsr.push(p);i.toggleClass("trSelected");if(z.osr.length!=0){z.nur.push(z.osr[0]);a("#row"+z.osr[0]).toggleClass("trSelected");}}}else{if(i.is(".trSelected")){return;}else{z.nsr.push(p);i.toggleClass("trSelected");if(z.osr.length!=0){z.nur.push(z.osr[0]);a("#row"+z.osr[0]).toggleClass("trSelected");}}}i.siblings().removeClass("trSelected");H.notifyForSelection();}else{if(z.selectionMode==2){if(s.ctrlKey){var g=null;if(i.is(".trSelected")){g=a.inArray(p,z.nsr);if(g!=-1){z.nsr.splice(g,1);}else{z.nur.push(p);}}else{g=a.inArray(p,z.nur);if(g!=-1){z.nur.splice(g,1);}else{z.nsr.push(p);}}i.toggleClass("trSelected");}else{if(i.is(".trSelected")){z.nur=a.makeArray(z.osr);z.nur.splice(a.inArray(p,z.nur),1);}else{z.nsr.push(p);z.nur=a.makeArray(z.osr);}i.addClass("trSelected");i.siblings().removeClass("trSelected");H.notifyForSelection();}}}H.selectedRow=i;},notifyForSelection:function(){if(z.onSelection){z.asr=a.merge(a.merge([],z.nsr),z.osr);a(z.nur).each(function(p,s){var g=a.inArray(s,z.asr);if(g!=null){z.asr.splice(g,1);}});z.onSelection.call(z.owner,z.asr,z.osr,z.nsr,z.nur);z.osr=a.makeArray(z.asr);z.nsr=a.makeArray();z.nur=a.makeArray();}},makeSelection:function(){},_rowClickHandler:function(i){var g=(i.target||i.srcElement);if(g.href||g.type){return true;}H.processSelection(a(this),i);i.stopPropagation();},addRowProp:function(g){if(a.inArray((/(\d*)$/.exec(g.attr("id"))[0]*1),z.asr)!=-1){g.addClass("trSelected");}g.click(H._rowClickHandler);if(a.browser.msie&&a.browser.version<7){g.hover(function(){a(this).addClass("trOver");},function(){a(this).removeClass("trOver");});}},pager:0,getCellHeader:function(g){if(g.is("th")){return g;}else{return a("tr:eq(0) > th:eq("+g.index()+")",a("#"+a.fn.fixID("HEADER."+z.ownerId)));}},renderCell:function(i,s,p){if(Echo.Render._disposedComponents==null){Echo.Render._disposedComponents={};}var g=null;if(typeof i=="number"){g=z.owner.component.getComponent(i);}else{g=i;}p.id="CELL."+g.renderId;H.renderCellLayoutData(g,s,p);Echo.Render.renderComponentAdd(new Echo.Update.ComponentUpdate(),g,s);if(z.onRenderCell){z.onRenderCell.call(z.owner,g);}},renderCellWidth:function(i,s){var t=a(i);var p=H.getCellHeader(t);var g=p.data("isUserSized");if(p!=t){if(g){t.css("width",p.css("width"));}else{t.css("width",s);}}else{if(!g){t.css("width",s);}}},renderCellHeight:function(i,g){i.style.height=g;},renderCellAlignment:function(Q,P,t){var i=a(P);var g=Echo.Sync.Alignment.getRenderedHorizontal(t);var p=typeof(t)=="object"?t.vertical:t;switch(g){case"center":i.css({margin:"0 auto","float":"none"});break;default:i.css({"float":g});break;}var s;switch(p){case"top":s="top";break;case"middle":s="middle";break;case"bottom":s="bottom";break;default:s="";break;}Q.style.verticalAlign=s;Q.style.textAlign="center";},renderCellInsets:function(i,g){Echo.Sync.Insets.render(g,i,"padding");},renderCellBackground:function(i,g){Echo.Sync.Color.render(g,i,"backgroundColor");},renderCellBackgroundImage:function(i,g){Echo.Sync.FillImage.render(g,i);},renderCellLayoutData:function(p,t,s){var g=null;if(typeof p=="number"){g=z.owner.component.getComponent(p);}else{g=p;}var i=g.render("layoutData");if(i){if(i.width){H.renderCellWidth(s,i.width);}if(i.height){H.renderCellHeight(s,i.height);}if(i.alignment){H.renderCellAlignment(s,t,i.alignment);}H.renderCellInsets(t,i.insets);H.renderCellBackground(s,i.background);H.renderCellBackgroundImage(t,i.backgroundImage);}if(Echo.Sync.Extent.isPercent(g.render("height"))){t.style.height="100%";}if(Echo.Sync.Extent.isPercent(g.render("width"))){t.style.width="100%";}},reloadPositions:function(){H.hDiv.style.top=H.mDiv.offsetHeight+"px";H.bDiv.style.top=z.headerVisible?(H.hDiv.offsetTop+H.hDiv.offsetHeight)+"px":H.hDiv.style.top;H.bDiv.style.bottom=H.pDiv.offsetHeight+"px";}};if(z.colModel){var I=document.createElement("thead");var d=document.createElement("tr");for(var E=0;E<z.colModel.length;E++){var q=z.colModel[E];var l=document.createElement("th");if(q.id!==null){a(l).attr("cmid",q.id);if(q.sortable){a(l).attr("abbr",q.id);}}a(l).attr("title",q.tooltip);if(q.hide||!q.visible){l.hide=true;}if(q.process){l.process=q.process;}a(l).data({rowDataIndex:E,componentIdx:q.cell.componentIdx,visible:q.visible});a(d).append(l);}a(I).append(d);a(x).prepend(I);}H.gDiv=document.createElement("div");H.mDiv=document.createElement("div");H.hDiv=document.createElement("div");H.bDiv=document.createElement("div");H.vDiv=document.createElement("div");H.rDiv=document.createElement("div");H.cDrag=document.createElement("div");H.block=document.createElement("div");H.nDiv=document.createElement("div");H.nBtn=document.createElement("div");H.iDiv=document.createElement("div");H.tDiv=document.createElement("div");H.sDiv=document.createElement("div");if(z.usepager||z.showPageStat){H.pDiv=document.createElement("div");}H.hTable=document.createElement("table");H.hTable.id="HEADER."+z.ownerId;H.gDiv.className="flexigrid";if(a.browser.msie){a(H.gDiv).addClass("ie");}if(z.novstripe){a(H.gDiv).addClass("novstripe");}a(x).before(H.gDiv);a(H.gDiv).append(x);if(z.buttons){H.tDiv.className="tDiv";var N=document.createElement("div");N.className="tDiv2";for(E=0;E<z.buttons.length;E++){var o=z.buttons[E];if(!o.separator){var F=document.createElement("div");F.className="fbutton";F.innerHTML="<div><span>"+o.name+"</span></div>";if(o.bclass){a("span",F).addClass(o.bclass).css({paddingLeft:20});}F.onpress=o.onpress;F.name=o.name;if(o.onpress){a(F).click(function(){this.onpress(this.name,H.gDiv);});}a(N).append(F);if(a.browser.msie&&a.browser.version<7){a(F).hover(function(){a(this).addClass("fbOver");},function(){a(this).removeClass("fbOver");});}}else{a(N).append("<div class='btnseparator'></div>");}}a(H.tDiv).append(N);a(H.tDiv).append("<div style='clear:both'></div>");a(H.gDiv).prepend(H.tDiv);}H.hDiv.className="hDiv";if(!z.headerVisible){H.hDiv.style.visibility="hidden";H.hDiv.style.height="0px";}a(x).before(H.hDiv);H.hTable.cellPadding=0;H.hTable.cellSpacing=0;a(H.hDiv).append('<div class="hDivBox"></div>');a("div",H.hDiv).append(H.hTable);var I=a("thead:first",x).get(0);if(I){a(H.hTable).append(I);}I=null;if(!z.colmodel){var w=0;}a("thead tr:first th",H.hDiv).each(function(){var i=a(this);var s=document.createElement("div");H.renderCell(i.data("componentIdx"),s,this);var g=i.attr("abbr");if(g){i.click(function(Q){if(!a(this).hasClass("thOver")){return false;}var P=(Q.target||Q.srcElement);if(P.href||P.type){return true;}var t=a("div",this);if(t.hasClass("active")){t.toggleClass("sasc");t.toggleClass("sdesc");}else{t.addClass("active");}H.changeSort(this,Q.ctrlKey);});if(z.sortModel&&z.sortModel.columns){for(E=0;E<z.sortModel.columns.length;E++){var p=z.sortModel.columns[E];if(g==p.columnId){i.addClass("sorted");s.className="s"+p.sortOrder;}}}}if(this.hide){i.hide();}if(!z.colmodel){i.attr("axis","col"+w++);}i.empty().append(s).removeAttr("width").mousedown(function(t){H.dragStart("colMove",t,this);}).hover(function(){if(!H.colresize&&!a(this).hasClass("thMove")&&!H.colCopy){a(this).addClass("thOver");}if(a(this).attr("abbr")){var W=a("div",this);var Q=a(this).hasClass("sorted");if(!Q&&!H.colCopy&&!H.colresize){W.addClass("s"+z.sortorder);}else{if(Q&&!H.colCopy&&!H.colresize){W.toggleClass("sasc");W.toggleClass("sdesc");}}}if(H.colCopy){var R=a("th",H.hDiv).index(this);if(R==H.dcoln){return false;}var S=i.offset();var V=null;if(R<H.dcoln){V=a(H.cdropleft);V.css("left",S.left);}else{V=a(H.cdropright);V.css("left",S.left+i.width()-16);}V.css("top",S.top+(i.height()/2)-8);i.append(V);H.dcolt=R;}else{if(!H.colresize){var U=a("th:visible",H.hDiv).index(this);var P=parseInt(a("div:eq("+U+")",H.cDrag).css("left"));var T=parseInt(a(H.nBtn).width())+parseInt(a(H.nBtn).css("borderLeftWidth"));var t=P-T+Math.floor(z.cgwidth/2);a(H.nDiv).hide();a(H.nBtn).hide();a(H.nBtn).css({left:t,top:H.hDiv.offsetTop,height:this.offsetHeight}).show();var X=parseInt(a(H.nDiv).width());a(H.nDiv).css({top:H.bDiv.offsetTop});if((t+X)>a(H.gDiv).width()){a(H.nDiv).css("left",P-X+1);}else{a(H.nDiv).css("left",t);}if(a(this).hasClass("sorted")){a(H.nBtn).addClass("srtd");}else{a(H.nBtn).removeClass("srtd");}}}},function(){a(this).removeClass("thOver");var t=a("div",this);if(!a(t).hasClass("active")){var t=a("div",this);if(!a(this).hasClass("sorted")){t.removeClass("s"+z.sortorder);}else{t.toggleClass("sasc");t.toggleClass("sdesc");}}else{a(t).removeClass("active");}if(H.colCopy){a(H.cdropleft).remove();a(H.cdropright).remove();H.dcolt=null;}});});H.bDiv.className="bDiv";a(x).before(H.bDiv);a(H.bDiv).scroll(function(g){H.scroll();return true;}).append(x);if(z.height=="auto"){a("table",H.bDiv).addClass("autoht");}a("tbody",H.bDiv).hide();var k=a("thead tr:first th:first",H.hDiv).get(0);if(k!=null){H.cDrag.className="cDrag";H.cdpad=0;H.cdpad+=(isNaN(parseInt(a("div",k).css("borderLeftWidth")))?0:parseInt(a("div",k).css("borderLeftWidth")));H.cdpad+=(isNaN(parseInt(a("div",k).css("borderRightWidth")))?0:parseInt(a("div",k).css("borderRightWidth")));H.cdpad+=(isNaN(parseInt(a("div",k).css("paddingLeft")))?0:parseInt(a("div",k).css("paddingLeft")));H.cdpad+=(isNaN(parseInt(a("div",k).css("paddingRight")))?0:parseInt(a("div",k).css("paddingRight")));H.cdpad+=(isNaN(parseInt(a(k).css("borderLeftWidth")))?0:parseInt(a(k).css("borderLeftWidth")));H.cdpad+=(isNaN(parseInt(a(k).css("borderRightWidth")))?0:parseInt(a(k).css("borderRightWidth")));H.cdpad+=(isNaN(parseInt(a(k).css("paddingLeft")))?0:parseInt(a(k).css("paddingLeft")));H.cdpad+=(isNaN(parseInt(a(k).css("paddingRight")))?0:parseInt(a(k).css("paddingRight")));a(H.bDiv).before(H.cDrag);var f=a(H.bDiv).height();var e=a(H.hDiv).height();a(H.cDrag).css({top:-e+"px"});a("thead tr:first th",H.hDiv).each(function(){var g=document.createElement("div");a(H.cDrag).append(g);if(!z.cgwidth){z.cgwidth=a(g).width();}a(g).css({height:f+e}).mousedown(function(i){H.dragStart("colresize",i,this);});if(a.browser.msie&&a.browser.version<7){H.fixHeight(a(H.gDiv).height());a(g).hover(function(){H.fixHeight();a(this).addClass("dragging");},function(){if(!H.colresize){a(this).removeClass("dragging");}});}});}if(z.resizable&&z.height!="auto"){H.vDiv.className="vGrip";a(H.vDiv).mousedown(function(g){H.dragStart("vresize",g);}).html("<span></span>");a(H.bDiv).after(H.vDiv);}if(z.resizable&&z.width!="auto"&&!z.nohresize){H.rDiv.className="hGrip";a(H.rDiv).mousedown(function(g){H.dragStart("vresize",g,true);}).html("<span></span>").css("height",a(H.gDiv).height());if(a.browser.msie&&a.browser.version<7){a(H.rDiv).hover(function(){a(this).addClass("hgOver");},function(){a(this).removeClass("hgOver");});}a(H.gDiv).append(H.rDiv);}if(z.usepager||z.showPageStat){H.pDiv.className="pDiv";H.pDiv.innerHTML='<div class="pDiv2"></div>';a(H.bDiv).after(H.pDiv);if(z.usepager){var c=' <div class="pGroup"> <div class="pFirst pButton"><span></span></div><div class="pPrev pButton"><span></span></div> </div> <div class="btnseparator"></div> <div class="pGroup"><span class="pcontrol">{page} <input type="text" size="4" value="1" /> {of} <span> 1 </span></span></div> <div class="btnseparator"></div> <div class="pGroup"> <div class="pNext pButton"><span></span></div><div class="pLast pButton"><span></span></div> </div>';c=c.replace(/{page}/,z.pageWord);c=c.replace(/{of}/,z.ofWord);a("div",H.pDiv).html(c);a(".pReload",H.pDiv).click(function(){H.populate();});a(".pFirst",H.pDiv).click(function(){H.changePage("first");});a(".pPrev",H.pDiv).click(function(){H.changePage("prev");});a(".pNext",H.pDiv).click(function(){H.changePage("next");});a(".pLast",H.pDiv).click(function(){H.changePage("last");});a(".pcontrol input",H.pDiv).keydown(function(g){if(g.keyCode==13){H.changePage("input");}});if(a.browser.msie&&a.browser.version<7){a(".pButton",H.pDiv).hover(function(){a(this).addClass("pBtnOver");},function(){a(this).removeClass("pBtnOver");});}if(z.useRp){var h="";for(var M=0;M<z.rpOptions.length;M++){if(z.rp==z.rpOptions[M]){A='selected="selected"';}else{A="";}h+="<option value='"+z.rpOptions[M]+"' "+A+" >"+z.rpOptions[M]+"&nbsp;&nbsp;</option>";}a(".pDiv2",H.pDiv).prepend("<div class='pGroup'><select name='rp'>"+h+"</select></div> <div class='btnseparator'></div>");a("select",H.pDiv).change(function(){z.newp=1;z.rp=+this.value;if(z.onRpChange){z.onRpChange.call(z.owner,+this.value);}else{H.populate();}});}}if(z.showPageStat){var D=' <div class="btnseparator"></div> <div class="pGroup"> <div class="pReload pButton"><span></span></div> </div> <div class="btnseparator"></div> <div class="pGroup"><span class="pPageStat"></span></div>';a(".pDiv2",H.pDiv).append(D);a(".pReload",H.pDiv).click(function(){H.populate();});}if(z.searchitems){a(".pDiv2",H.pDiv).prepend("<div class='pGroup'> <div class='pSearch pButton'><span></span></div> </div>  <div class='btnseparator'></div>");a(".pSearch",H.pDiv).click(function(){a(H.sDiv).slideToggle("fast",function(){a(".sDiv:visible input:first",H.gDiv).trigger("focus");});});H.sDiv.className="sDiv";var C=z.searchitems;var j="";for(var y=0;y<C.length;y++){if(z.qtype==""&&C[y].isdefault==true){z.qtype=C[y].name;var A='selected="selected"';}else{A="";}j+="<option value='"+C[y].name+"' "+A+" >"+C[y].display+"&nbsp;&nbsp;</option>";}if(z.qtype==""){z.qtype=C[0].name;}a(H.sDiv).append("<div class='sDiv2'>Quick Search <input type='text' size='30' name='q' class='qsbox' /> <select name='qtype'>"+j+"</select> <input type='button' value='Clear' /></div>");a("input[name=q],select[name=qtype]",H.sDiv).keydown(function(g){if(g.keyCode==13){H.doSearch();}});a("input[value=Clear]",H.sDiv).click(function(){a("input[name=q]",H.sDiv).val("");z.query="";H.doSearch();});a(H.bDiv).after(H.sDiv);}}a(H.pDiv,H.sDiv).append("<div style='clear:both'></div>");if(z.title){H.mDiv.className="mDiv";H.mDiv.innerHTML='<div class="ftitle">'+z.title+"</div>";a(H.gDiv).prepend(H.mDiv);if(z.showTableToggleBtn){a(H.mDiv).append('<div class="ptogtitle" title="'+z.mintablemsg+'"><span></span></div>');a("div.ptogtitle",H.mDiv).click(function(){a(H.hDiv).toggle();a(H.bDiv).toggle();a(H.pDiv).toggle();a(H.gDiv).toggleClass("hideBody");a(this).toggleClass("vsble");});}}H.cdropleft=document.createElement("span");H.cdropleft.className="cdropleft";H.cdropright=document.createElement("span");H.cdropright.className="cdropright";H.block.className="gBlock";var K=a(H.bDiv).height();var O=H.bDiv.offsetTop;a(H.block).css({width:H.bDiv.style.width,height:K,background:"white",position:"relative",marginBottom:(K*-1),zIndex:1,top:O,left:"0px"});a(H.block).fadeTo(0,z.blockOpacity);if(a("th",H.hDiv).length){H.nDiv.className="nDiv";H.nDiv.innerHTML="<table cellpadding='0' cellspacing='0'><tbody></tbody></table>";a(H.nDiv).css({marginBottom:(K*-1),display:"none",top:O}).noSelect();a("th div",H.hDiv).each(function(i){var p=a("th[axis='col"+i+"']",H.hDiv);var g='checked = "checked"';if(p.css("display")=="none"){g="";}var s=document.createElement("tr");if(!p.data("visible")){a(s).css("display","none");}a("tbody",H.nDiv).append(s);a(s).append('<td class="ndcol1"><input type="checkbox" '+g+' class="togCol" value="'+i+'" /></td><td class="ndcol2">'+p.html()+"</td>");});if(a.browser.msie&&a.browser.version<7){a("tr",H.nDiv).hover(function(){a(this).addClass("ndcolover");},function(){a(this).removeClass("ndcolover");});}a("td.ndcol2",H.nDiv).click(function(){if(a("input:checked",H.nDiv).length<=z.minColToggle&&a(this).prev().find("input")[0].checked){return false;}return H.toggleCol(a(this).prev().find("input").val());});a("input.togCol",H.nDiv).click(function(){if(a("input:checked",H.nDiv).length<z.minColToggle&&!this.checked){return false;}a(this).parent().next().trigger("click");});a(H.gDiv).prepend(H.nDiv);a(H.nBtn).addClass("nBtn").html("<div></div>").attr("title",z.hidecolmsg).click(function(){a(H.nDiv).fadeToggle("fast");return true;});if(z.showToggleBtn){a(H.gDiv).prepend(H.nBtn);}}a(H.iDiv).addClass("iDiv").css({display:"none"});a(H.bDiv).append(H.iDiv);a(H.bDiv).hover(function(){a(H.nDiv).hide();a(H.nBtn).hide();},function(){if(H.multisel){H.multisel=false;}});a(H.gDiv).hover(function(){},function(){a(H.nDiv).hide();a(H.nBtn).hide();});a(document).mousemove(L).mouseup(B).mouseenter(m).mouseleave(n);function L(g){H.dragMove(g);}function B(){H.dragEnd();}function m(){}function n(){H.dragEnd();}H.cleanup=function(){a(document).unbind("mousemove",L).unbind("mouseup",B).unbind("mouseenter",m).unbind("mouseleave",n);a(x.grid.gDiv).remove();z.onToggleCol=null;z.onChangeSort=null;z.preProcess=null;z.onSuccess=null;z.onChangePage=null;z.onSubmit=null;z.onPopulateCallback=null;z.onDragCol=null;z.onResizeCol=null;z.onResizeGrid=null;z=null;H=null;x.grid=null;x.p=null;x=null;};H.focus=function(g){if(this.loading){H.lazyFocus=H.focus;}else{H.lazyFocus=null;if(!a("table tbody tr").hasClass("trSelected")){if(g){}else{a("table tbody tr").removeClass("trSelected");}}}};H.remoteControl=function(s){if(H.selectedRow&&H.selectedRow!=null){var i=s.keyCode;if(s.keyCode==13){H.selectedRow.trigger("click");}else{if(s.keyCode==40){var p=H.selectedRow.next();if(p.is("tr")){H.processSelection(p,s);var t=0;p.prevAll().each(function(){t+=a(this).height();});if(a(H.bDiv).height()/2.3<t){H.bDiv.scrollTop=H.bDiv.scrollTop+p.height();}}}else{if(s.keyCode==38){var g=H.selectedRow.prev();if(g.is("tr")){H.processSelection(g,s);var t=0;g.nextAll().each(function(){t+=a(this).height();});if(a(H.bDiv).height()/2.3<t){H.bDiv.scrollTop=H.bDiv.scrollTop-g.height();}}}else{if(s.keyCode==39){H.bDiv.scrollLeft=H.bDiv.scrollLeft+50;H.scroll();}else{if(s.keyCode==37){H.bDiv.scrollLeft=H.bDiv.scrollLeft-50;H.scroll();}}}}}}return true;};H.multiSort=function(p,P,V){var U=p.columns;var R=new Array();for(T=0;T<U.length;T++){var W=U[T];for(var g=0;g<P.columns.length;g++){if(P.columns[g].id==W.columnId){R.push(new Object({index:g,order:W.sortOrder}));}}}R.reverse();var S=new Array();for(var T=0;T<V.pages.length;T++){S=S.concat(V.pages[T].rows);}var Q=new RegExp("[\\"+z.digitGroupDL+"]","g");var i=new RegExp("[\\"+z.decimalDelimiter+"]","g");S=t(R,S);var s=V.pages[0];s.rows=S;return V;function t(Y,ac){for(T=0;T<Y.length;T++){var aa=Y[T].index;var Z=Y[T].order;ac.sort(ab);}return ac;function ab(ai,ah){var af=z.owner.component.getComponent(ai.cells[aa].componentIdx).get("text");var ae=z.owner.component.getComponent(ah.cells[aa].componentIdx).get("text");if(!af&&!ae){return 0;}else{if(!af&&ae){return -1;}else{if(af&&!ae){return 1;}}}var ad;if(X(af)&&X(ae)){if(typeof af!="number"){var aj=af.replace(Q,"");}if(typeof(aj)!="undefined"){aj=(+aj.replace(i,"."));}if(typeof ae!="number"){var ag=ae.replace(Q,"");}if(typeof(ag)!="undefined"){ag=ag.replace(i,".");}ad=Z=="asc"?aj-ag:ag-aj;}else{if(af==ae){ad=0;}if(Z=="asc"){ad=(af<ae)?-1:1;}else{ad=(af>ae)?-1:1;}}return ad;}function X(ae){if(typeof ae=="number"){return true;}var ag="\\"+z.digitGroupDL;var ad="\\"+z.decimalDelimiter;var af="(^([-+]?[\\d"+ag+ad+"]*)$)";return RegExp(af).test(a.trim(ae));}}};H.reload=function(){H.loading=false;H.populate();};if(a.browser.msie&&a.browser.version<7){a(".hDiv,.bDiv,.mDiv,.pDiv,.vGrip,.tDiv, .sDiv",H.gDiv).css({width:"100%"});a(H.gDiv).addClass("ie6");if(z.width!="auto"){a(H.gDiv).addClass("ie6fullwidthbug");}}x.p=z;x.grid=H;if(z.url&&z.autoload){H.populate();}else{H.setBusy(true);function b(){H.setBusy(false);a("tbody",H.bDiv).show();}var G=a("thead tr:first th",H.hDiv);var v=a("tbody tr",H.bDiv);var r=0;function J(){if(r<v.length){var s=v[r];if(s){var p=a(s);var g=0;a("td",s).each(function(){var i=false;if(G.length>g){i=G[g]||false;}H.addCellProp(this,s,this.innerHTML,i);g++;});H.addRowProp(p);r++;setTimeout(J,1);}else{b();}}else{b();}}setTimeout(J,1);}H.reloadPositions();return x;};a.fn.flexigrid=function(b){return this.each(function(){a.addFlex(this,b);});};a.fn.flexReload=function(b){return this.each(function(){if(this.grid){return this.grid.reload();}});};a.fn.flexOptions=function(b){return this.each(function(){if(this.grid){a.extend(this.p,b);}});};a.fn.flexToggleCol=function(c,b){return this.each(function(){if(this.grid){this.grid.toggleCol(c,b);}});};a.fn.flexAddData=function(b){return this.each(function(){if(this.grid){this.grid.setBusy(true);this.grid.addData(b);}});};a.fn.noSelect=function(c){if(c==null){var b=true;}else{b=c;}if(b){return this.each(function(){if(a.browser.msie||a.browser.safari){a(this).bind("selectstart",function(){return false;});}else{if(a.browser.mozilla){a(this).css("MozUserSelect","none");a("body").trigger("focus");}else{if(a.browser.opera){a(this).bind("mousedown",function(){return false;});}else{a(this).attr("unselectable","on");}}}});}else{return this.each(function(){if(a.browser.msie||a.browser.safari){a(this).unbind("selectstart");}else{if(a.browser.mozilla){a(this).css("MozUserSelect","inherit");}else{if(a.browser.opera){a(this).unbind("mousedown");}else{a(this).removeAttr("unselectable","on");}}}});}};a.fn.flexDestroy=function(){return this.each(function(){if(this.grid){this.grid.cleanup();}});};a.fn.flexMultiSort=function(c,b,d){return this.each(function(){if(this.grid){this.grid.multiSort(c,b,d);}});};a.fn.flexFocus=function(b){return this.each(function(){if(this.grid){this.grid.focus(b);}});};a.fn.flexFixHeight=function(){return this.each(function(){if(this.grid){this.grid.fixHeight();}});};a.fn.flexRemoteControl=function(b){return this.each(function(){if(this.grid){this.grid.remoteControl(b);}});};a.fn.flexCheckSelection=function(){return this.each(function(){if(this.grid){this.grid.notifyForSelection();}});};a.fn.flexMakeSelection=function(b){return this.each(function(){if(this.grid){this.grid.makeSelection(b);}});};a.fn.flexGetCounterIndexes=function(){var c=[];var h=this[0].p;var e=this[0].grid;if(e){var d=a("th[cmid='-1']",e.hDiv);if(d[0]){c[0]=/(\d*)$/.exec(d.attr("id"))[0]*1;var b=d.index();var f=a("#"+a.fn.fixID(h.ownerId+".DATA")).children("tr");f.each(function(g,i){c[g+1]=/(\d*)$/.exec(a(i).children()[b].id)[0]*1;});}}return c;};a.fn.flexRenderChilds=function(b){return this.each(function(){if(this.grid){this.grid.setBusy(true);var d=0;var c=Core.Web.Scheduler.run(Core.method(this,function(){var h=50;while(h>0&&d<b.length){var f=b[d];var e=document.getElementById(f);var g=document.createElement("div");this.grid.renderCell(/(\d*)$/.exec(f)[0]*1,g,e);a(e).empty().append(g);d++;h--;}if(d==b.length){Core.Web.Scheduler.remove(c);this.grid.setBusy(false);this.grid.reloadPositions();}}),1,true);}});};a.fn.flexRenderLayoutChilds=function(b){return this.each(function(){if(this.grid){this.grid.setBusy(true);var d=0;var c=Core.Web.Scheduler.run(Core.method(this,function(){var g=50;while(g>0&&d<b.length){var f=b[d];var e=document.getElementById(f);this.grid.renderCellLayoutData(/(\d*)$/.exec(f)[0]*1,e.firstChild,e);d++;g--;}if(d==b.length){Core.Web.Scheduler.remove(c);this.grid.setBusy(false);this.grid.reloadPositions();this.grid.rePosDrag();}}),1,true);}});};a.fn.flexUpdateColumns=function(b){return this.each(function(){if(this.grid){var d=this.grid;var j=function(k,l){var m=a(a("td.ndcol2",d.nDiv)[k.index()]);var g=m.prev().find("input")[0].checked;if(g==l){m.trigger("click");}};for(u=0;u<b.length;u++){var c=a("th[cmid='"+b[u].ID+"']",d.hDiv);for(var h=0;h<b[u].props.length;h++){var f=b[u].props[h][0];var i=b[u].props[h][1];switch(f){case exxcellent.FlexiGrid.COL_UPDATE_TOOLTIP:c.attr("title",i);break;case exxcellent.FlexiGrid.COL_UPDATE_SORTABLE:break;case exxcellent.FlexiGrid.COL_UPDATE_HIDED:j(c,i);break;case exxcellent.FlexiGrid.COL_UPDATE_VISIBLE:j(c,!i);var e=a(a("td.ndcol2",d.nDiv)[c.index()]).parent();if(i){e.css("display","");}else{e.css("display","none");}break;default:throw new Error("Unsupported column update property: "+f);break;}}}this.grid.reloadPositions();}});};a.fn.fixID=function(b){return b.replace(/(:|\.)/g,"\\$1");};a.fn.unselectable=function(){return this.each(function(){a(this).css("-moz-user-select","none").css("-khtml-user-select","none").css("user-select","none");if(a.browser.msie){a(this).each(function(){this.ondrag=function(){return false;};});a(this).each(function(){this.onselectstart=function(){return(false);};});}else{if(a.browser.opera){a(this).attr("unselectable","on");}}});};})(jQuery);