(function(a){a.addFlex=function(F,I){if(F.grid){return false;}I=a.extend({height:"auto",width:"auto",striped:true,novstripe:false,minwidth:30,minheight:80,resizable:false,url:false,method:"POST",dataType:"xml",errormsg:"Connection Error",usepager:false,nowrap:true,page:1,total:1,useRp:true,rp:15,rpOptions:[10,15,20,25,40],title:false,colModel:false,pagestat:"Displaying {from} to {to} of {total} items",procmsg:"Processing, please wait ...",hidecolmsg:"Hide/Show Columns",mintablemsg:"Minimize/Maximize Table",query:"",qtype:"",nomsg:"No items",pageWord:"Page",ofWord:"of",minColToggle:1,showToggleBtn:true,showPageStat:true,hideOnSubmit:true,autoload:true,blockOpacity:0.5,onToggleCol:false,onChangeSort:false,onSuccess:false,onChangePage:false,onSubmit:false,onPopulateCallback:false,onDragCol:false,onResizeCol:false,onResizeGrid:false,owner:false,debug:false,sortorder:"asc",sortModel:{columns:[]},clientsort:true,digitGroupDL:".",decimalDelimiter:",",heightOffset:100,searchitems:false},I);a(F).show().attr({cellPadding:0,cellSpacing:0,border:0}).removeAttr("width");var M={hset:{},rePosDrag:function(){var s=0-this.hDiv.scrollLeft;if(this.hDiv.scrollLeft>0){s-=Math.floor(I.cgwidth/2);}M.cDrag.style.top=(M.hDiv.offsetTop+1)+"px";var p=this.cdpad;var i=a("div",M.cDrag);i.hide();var g=a("thead tr:first th:visible",this.hTable);for(var U=0;U<g.length;U++){var t=parseInt(a(g[U]).width());if(s==0){s-=Math.floor(I.cgwidth/2);}t=t+s+p;i[U].style.left=t+"px";s=t;}i.show();},fixHeight:function(i){if(!i){i=a(M.bDiv).height();}var p=a(this.hDiv).height();a("div",this.cDrag).each(function(){a(this).height(i+p);});a(M.block).css({height:i,marginBottom:(i*-1)});var g=M.bDiv.offsetTop+i;if(I.height!="auto"&&I.resizable){g=M.vDiv.offsetTop;}a(M.rDiv).css({height:g});},dragStart:function(t,s,p){if(t=="colresize"){a(M.nDiv).hide();a(M.nBtn).hide();var U=a("div",this.cDrag).index(p);var g=a("th:visible:eq("+U+")",this.hDiv).width();a(p).addClass("dragging").siblings().hide();a(p).prev().addClass("dragging").show();this.colresize=a.extend(true,{},{startX:s.pageX,ol:parseInt(p.style.left),ow:g,n:U});a("body").css("cursor","col-resize");}else{if(t=="vresize"){var i=false;a("body").css("cursor","row-resize");if(p){i=true;a("body").css("cursor","col-resize");}this.vresize={h:I.height,sy:s.pageY,w:I.width,sx:s.pageX,hgo:i};}else{if(t=="colMove"){a(M.nDiv).hide();a(M.nBtn).hide();this.hset=a(this.hDiv).offset();this.hset.right=this.hset.left+a("table",this.hDiv).width();this.hset.bottom=this.hset.top+a("table",this.hDiv).height();this.dcol=p;this.dcoln=a("th",this.hDiv).index(p);this.colCopy=document.createElement("div");this.colCopy.className="colCopy";this.colCopy.innerHTML=p.innerHTML;if(a.browser.msie){this.colCopy.className="colCopy ie";}a(this.colCopy).css({position:"absolute","float":"left",display:"none",textAlign:p.align});a("body").append(this.colCopy);a(this.cDrag).hide();}}}a(M.gDiv).noSelect();},dragMove:function(t){if(this.colresize){var i=this.colresize.n;var Y=t.pageX-this.colresize.startX;var U=this.colresize.ol+Y;var s=this.colresize.ow+Y;if(s>I.minwidth){a("div:eq("+i+")",this.cDrag).css("left",U);this.colresize.nw=s;}}else{if(this.vresize){var Z=this.vresize;var W=t.pageY;var Y=W-Z.sy;if(!I.defwidth){I.defwidth=I.width;}if(I.width!="auto"&&!I.nohresize&&Z.hgo){var X=t.pageX;var p=X-Z.sx;var g=Z.w+p;if(g>I.defwidth){this.gDiv.style.width=g+"px";I.width=g;}}var V=Z.h+Y;if((V>I.minheight||I.height<I.minheight)&&!Z.hgo){this.bDiv.style.height=V+"px";I.height=V;this.fixHeight(V);}Z=null;}else{if(this.colCopy){a(this.dcol).addClass("thMove").removeClass("thOver");if(t.pageX>this.hset.right||t.pageX<this.hset.left||t.pageY>this.hset.bottom||t.pageY<this.hset.top){a("body").css("cursor","move");}else{a("body").css("cursor","pointer");}a(this.colCopy).css({top:t.pageY+10,left:t.pageX+20,display:"block"});}}}},dragEnd:function(){if(this.colresize){M.setBusy(true);var s=this.colresize.n;var V=this.colresize.nw;var U=a("th:visible:eq("+s+")",this.hDiv);U.css("width",V);U.data("isUserSized",true);var X=a("#"+a.fn.fixID(I.ownerId+".DATA")).children("tr");var g=0;var t=Core.Web.Scheduler.run(Core.method(this,function(){var ac=50;while(ac-->0&&g<X.length){var ab=a(X[g++]).children("td:visible:eq("+s+")");ab.css("width",V);var Y=a(":first-child",ab[0]);var aa=ab.attr("title");if(V<Y.width()&&!aa){var Z=I.owner.component.getComponent(/(\d*)$/.exec(ab.attr("id"))[0]*1);ab.attr("title",Z.get("text"));}else{if(V>=Y.width()&&aa){ab.removeAttr("title");}}}if(g==X.length){Core.Web.Scheduler.remove(t);M.setBusy(false);}}),1,true);this.hDiv.scrollLeft=this.bDiv.scrollLeft;a("div:eq("+s+")",this.cDrag).siblings().show();a(".dragging",this.cDrag).removeClass("dragging");this.rePosDrag();this.fixHeight();this.colresize=false;if(I.onResizeCol&&I.colModel){var i=I.colModel[s].id;I.onResizeCol.call(I.owner,i,V);}}else{if(this.vresize){this.vresize=false;if(I.onResizeGrid){I.onResizeGrid.call(I.owner,I.width,I.height);}}else{if(this.colCopy){a(this.colCopy).remove();if(this.dcolt!=null){if(this.dcoln>this.dcolt){a("th:eq("+this.dcolt+")",this.hDiv).before(this.dcol);}else{a("th:eq("+this.dcolt+")",this.hDiv).after(this.dcol);}this.switchCol(this.dcoln,this.dcolt);a(this.cdropleft).remove();a(this.cdropright).remove();this.rePosDrag();if(I.onDragCol&&I.colModel){var p=I.colModel[this.dcoln].id;}var W=I.colModel[this.dcolt].id;I.onDragCol.call(I.owner,p,W);}this.dcol=null;this.hset=null;this.dcoln=null;this.dcolt=null;this.colCopy=null;a(".thMove",this.hDiv).removeClass("thMove");a(this.cDrag).show();}}}a("body").css("cursor","default");a(M.gDiv).noSelect(false);},toggleCol:function(W,U){var i=a("th[axis='col"+W+"']",this.hDiv)[0];var V=a("thead th",M.hDiv).index(i);var g=a("input[value="+W+"]",M.nDiv)[0];if(U==null){U=i.hide;}if(a("input:checked",M.nDiv).length<I.minColToggle&&!U){return false;}if(U){i.hide=false;a(i).show();g.checked=true;}else{i.hide=true;a(i).hide();g.checked=false;}var t=a("#"+a.fn.fixID(I.ownerId+".DATA"));var s=t.children("tr");s.each(function(){a(this).children("td:eq("+V+")").toggle();});this.rePosDrag();if(I.onToggleCol&&I.colModel){var p=I.colModel[W].id;I.onToggleCol.call(I.owner,p,U);}return U;},switchCol:function(i,g){var s=a("#"+a.fn.fixID(I.ownerId+".DATA"));var p=s.children("tr");p.each(function(){var V=a(this);var t=V.children("td:eq("+g+")");var U=V.children("td:eq("+i+")");if(i>g){t.before(U);}else{t.after(U);}});if(i>g){a("tr:eq("+g+")",this.nDiv).before(a("tr:eq("+i+")",this.nDiv));}else{a("tr:eq("+g+")",this.nDiv).after(a("tr:eq("+i+")",this.nDiv));}if(a.browser.msie&&a.browser.version<7){a("tr:eq("+g+") input",this.nDiv)[0].attr("checked",true);}this.hDiv.scrollLeft=this.bDiv.scrollLeft;},scroll:function(){this.hDiv.scrollLeft=this.bDiv.scrollLeft;this.rePosDrag();},addData:function(ah){this.data=ah;if(!ah){i();return false;}if(I.dataType!="xml"){I.total=ah.total;I.page=ah.page;}else{I.total=+a("rows total",ah).text();I.page=+a("rows page",ah).text();}I.pages=I.rp==-1?1:Math.ceil(I.total/I.rp);if(I.total==0){a("tr, a, td, div",F).unbind();a(F).empty();I.pages=1;I.page=1;i();a(".pPageStat",this.pDiv).html(I.nomsg);return false;}if(I.rp==-1&&this.data&&I.clientsort&&I.sortModel&&I.sortModel.columns.length>0){this.multiSort(I.sortModel,new exxcellent.model.ColumnModel(I.colModel),new exxcellent.model.TableModel(new Array(this.data)));}if(I.height=="auto"){var p=a(M.gDiv);var W=p.offsetParent().attr("offsetHeight")-I.heightOffset;a(M.bDiv).css({height:W+"px"});}var U=a("thead tr:first th",M.hDiv);if(!this.dataDOM){var g=document.createElement("tbody");var V=document.createElement("tr");var Y=document.createElement("td");Y.appendChild(document.createElement("div"));if(!I.nowrap){Y.style.whiteSpace="normal";}for(var af=0;af<U.length;af++){V.appendChild(Y.cloneNode(true));}for(var ab=0;ab<ah.rows.length;ab++){g.appendChild(V.cloneNode(true));}this.dataDOM=g;}else{var ac=ah.rows.length-this.dataDOM.childNodes.length;if(ac>0){while(ac-->0){this.dataDOM.appendChild(this.dataDOM.childNodes[0].cloneNode(true));}}else{if(ac<0){while(ac++<0){this.dataDOM.removeChild(this.dataDOM.childNodes[0]);}}}}var Z=this.dataDOM.cloneNode(true);Z.id=I.ownerId+".DATA";var ag=a(Z);function i(){var ai=a(F);a("tr",ai).unbind();ai.empty().append(ag);if(ah.rows.length!=0){M.rePosDrag();M.fixHeight();}Z=null;ag=null;ah=null;if(I.onSuccess){I.onSuccess.call(I.owner);}M.setBusy(false);if(M.lazyFocus){M.lazyFocus.call(this,true);}M.buildpager();M.notifyForSelection();}if(I.dataType=="json"){var ae=0;var X=null;var t=null;var s=null;var ad=null;var aa=Core.Web.Scheduler.run(Core.method(this,function(){var ak=function(am){var al=(am.target||am.srcElement);if(al.href||al.type){return true;}M.processSelection(a(this),am);am.stopPropagation();};var aj=20;while(ah&&ah.rows.length>ae&&ah.rows[ae]&&aj>0){X=ah.rows[ae];s=Z.childNodes[ae];if(X.id!==null){s.id=I.ownerId+".ROW."+X.id;}if(ae%2&&I.striped){s.className+=" erow";}if(a.inArray(X.id,I.asr)!=-1){s.className+=" trSelected";}s.onclick=ak;for(var ai=0;ai<U.length;ai++){ad=a(U[ai]);t=Z.childNodes[ae].childNodes[ai];if(ad.hasClass("sorted")){t.className+=" sorted";}if(U[ai].hide){t.style.display="none";}M.renderCell(X.cells[ad.data("rowDataIndex")].componentIdx,t.childNodes[0],t,ad);}ae++;aj--;}if(ae==ah.rows.length){Core.Web.Scheduler.remove(aa);i();}}),1,true);}else{throw new Error('DataType "'+I.dataType+'" could not be handled.');}},changeSort:function(p,W){if(this.loading){return true;}a(M.nDiv).hide();a(M.nBtn).hide();if(!W){I.sortModel.columns=[];var ae=a("div",p);a("thead tr:first th div",this.hDiv).not(ae).removeClass("sdesc").removeClass("sasc");a(p).siblings().removeClass("sorted");}var ab=a("div",p);var t=a(p).hasClass("sorted");var s=new Object();var ac=a(p).attr("abbr");var U=a(p,p.parentNode).index();if(t){var ad="";if(I.sortModel.columns.length>0){for(var aa=0;aa<I.sortModel.columns.length;aa++){var X=I.sortModel.columns[aa];if(X.columnId==ac){X.sortOrder=(a(ab).hasClass("sasc")?"asc":"desc");s=X;break;}}}else{s=new Object({columnId:ac,columnIdx:U,sortOrder:(a(ab).hasClass("sasc")?"asc":"desc")});I.sortModel.columns.push(s);}}else{if(!t){a(p).addClass("sorted");ab.addClass("s"+I.sortorder);s=new Object({columnId:ac,columnIdx:U,sortOrder:I.sortorder});I.sortModel.columns.push(s);}}if(I.rp!=-1){if(I.onChangeSort){I.onChangeSort.call(I.owner,I.sortModel);}}else{this.setBusy(true);var i=JSON.parse(JSON.stringify(this.data));this.multiSort(I.sortModel,new exxcellent.model.ColumnModel(I.colModel),new exxcellent.model.TableModel(new Array(i)));this.data=i;var Z=[];a(I.sortModel.columns).each(function(ah,ag){Z.push(ag.columnIdx);});var Y=function(ag,ah){if(Core.Arrays.indexOf(Z,ag)>=0){a(ah).addClass("sorted");}else{a(ah).removeClass("sorted");}};var af=a("#"+a.fn.fixID(I.ownerId+".DATA"));var g=0;var V=Core.Web.Scheduler.run(Core.method(this,function(){var ah=50;while(ah>0&&i.rows.length>g){var ag=a("#"+a.fn.fixID(I.ownerId+".ROW."+i.rows[g].id));ag.children().each(Y);if(g%2==0&&I.striped){ag.removeClass("erow");}else{ag.addClass("erow");}af.append(ag);ah--;g++;}if(g==i.rows.length){Core.Web.Scheduler.remove(V);M.setBusy(false);if(I.onChangeSort){I.onChangeSort.call(I.owner,I.sortModel);}}}),1,true);}},buildpager:function(){a(".pcontrol input",this.pDiv).val(I.page);a(".pcontrol span",this.pDiv).html(I.pages);var i=(I.page-1)*I.rp+1;var g=I.rp==-1?I.total:i+I.rp-1;if(I.total<g){g=I.total;}var p=I.pagestat;p=p.replace(/{from}/,i);p=p.replace(/{to}/,g);p=p.replace(/{total}/,I.total);a(".pPageStat",this.pDiv).html(p);},setBusy:function(s){var g=false;var p=a(".pPageStat",this.pDiv);if(s){if(!this.loading){this.loading=true;p.data("content",p.html());p.html(I.procmsg);a(".pReload",this.pDiv).addClass("loading");a(M.block).css({top:M.bDiv.offsetTop,position:"absolute",width:M.bDiv.offsetWidth,height:M.bDiv.offsetHeight});if(I.hideOnSubmit){a(this.gDiv).prepend(M.block);}if(a.browser.opera){a(F).css("visibility","hidden");}g=true;}}else{if(this.loading){var i=a(".pPageStat",this.pDiv);if(i.html()==I.procmsg){p.html(p.data("content"));}a(".pReload",this.pDiv).removeClass("loading");if(I.hideOnSubmit){a(M.block).remove();}M.hDiv.scrollLeft=M.bDiv.scrollLeft;if(a.browser.opera){a(F).css("visibility","visible");}this.loading=false;g=true;}}return g;},populate:function(){if(this.loading){return true;}if(I.onSubmit){var g=I.onSubmit();if(!g){return false;}}if(!I.url){return false;}this.setBusy(true);if(!I.newp){I.newp=1;}if(I.page>I.pages){I.page=I.pages;}var s=[{name:"page",value:I.newp},{name:"rp",value:I.rp},{name:"query",value:I.query},{name:"qtype",value:I.qtype}];var i=[];for(K in s){var p=s[K];if(p&&p.name&&p.value){i.push(p);}}i=I.onPopulateCallback.call(I.owner,i);M.addData(i);},doSearch:function(){I.query=a("input[name=q]",M.sDiv).val();I.qtype=a("select[name=qtype]",M.sDiv).val();I.newp=1;this.populate();},changePage:function(i){if(this.loading){return true;}switch(i){case"first":I.newp=1;break;case"prev":if(I.page>1){I.newp=parseInt(I.page)-1;}break;case"next":if(I.page<I.pages){I.newp=parseInt(I.page)+1;}break;case"last":I.newp=I.pages;break;case"input":var g=parseInt(a(".pcontrol input",this.pDiv).val());if(isNaN(g)){g=1;}if(g<1){g=1;}else{if(g>I.pages){g=I.pages;}}a(".pcontrol input",this.pDiv).val(g);I.newp=g;break;}if(I.newp==I.page){return false;}if(I.onChangePage){I.onChangePage.call(I.owner,I.newp);}else{this.populate();}},getCellDim:function(p){var V=parseInt(a(p).height());var g=parseInt(a(p).parent().height());var t=parseInt(p.style.width);var X=parseInt(a(p).parent().width());var U=p.offsetParent.offsetTop;var i=p.offsetParent.offsetLeft;var W=parseInt(a(p).css("paddingLeft"));var s=parseInt(a(p).css("paddingTop"));return{ht:V,wt:t,top:U,left:i,pdl:W,pdt:s,pht:g,pwt:X};},clearSelection:function(){this.selectedRow=null;a(this.gDiv).noSelect();},processSelection:function(i,s){if(I.selectionMode==0){return;}var p=/(\d*)$/.exec(i.attr("id"))[0]*1;if(I.selectionMode==1){if(s.ctrlKey){if(i.is(".trSelected")){I.nur.push(p);i.toggleClass("trSelected");}else{I.nsr.push(p);i.toggleClass("trSelected");if(I.osr.length!=0){I.nur.push(I.osr[0]);a("#row"+I.osr[0]).toggleClass("trSelected");}}}else{if(i.is(".trSelected")){return;}else{I.nsr.push(p);i.toggleClass("trSelected");if(I.osr.length!=0){I.nur.push(I.osr[0]);a("#row"+I.osr[0]).toggleClass("trSelected");}}}i.siblings().removeClass("trSelected");M.notifyForSelection();}else{if(I.selectionMode==2){if(s.ctrlKey){var g=null;if(i.is(".trSelected")){g=a.inArray(p,I.nsr);if(g!=-1){I.nsr.splice(g,1);}else{I.nur.push(p);}}else{g=a.inArray(p,I.nur);if(g!=-1){I.nur.splice(g,1);}else{I.nsr.push(p);}}i.toggleClass("trSelected");}else{if(i.is(".trSelected")){I.nur=a.makeArray(I.osr);I.nur.splice(a.inArray(p,I.nur),1);}else{I.nsr.push(p);I.nur=a.makeArray(I.osr);}i.addClass("trSelected");i.siblings().removeClass("trSelected");M.notifyForSelection();}}}M.selectedRow=i;},notifyForSelection:function(){if(I.onSelection){I.asr=a.merge(a.merge([],I.nsr),I.osr);a(I.nur).each(function(p,s){var g=a.inArray(s,I.asr);if(g!=null){I.asr.splice(g,1);}});I.onSelection.call(I.owner,I.asr,I.osr,I.nsr,I.nur);I.osr=a.makeArray(I.asr);I.nsr=a.makeArray();I.nur=a.makeArray();}},makeSelection:function(){},addRowProp:function(g){},pager:0,getCellHeader:function(g){if(g.is("th")){return g;}else{return a("tr:eq(0) > th:eq("+g.index()+")",this.hTable);}},renderCell:function(p,t,s,i){if(Echo.Render._disposedComponents==null){Echo.Render._disposedComponents={};}var g=null;if(typeof p=="number"){g=I.owner.component.getComponent(p);}else{g=p;}s.id="CELL."+g.renderId;M.renderCellLayoutData(g,t,s,i);Echo.Render.renderComponentAdd(new Echo.Update.ComponentUpdate(),g,t);if(I.onRenderCell){I.onRenderCell.call(I.owner,g);}},renderCellLayoutData:function(V,g,t,X){var Y=null;if(typeof V=="number"){Y=I.owner.component.getComponent(V);}else{Y=V;}var W=Y.render("layoutData");if(W){if(W.width){if(!X){X=M.getCellHeader(a(t));}var p=X.data("isUserSized");if(t!=X[0]){if(!p){t.style.width=W.width;}else{t.style.width=X[0].style.width;}}else{if(!p){t.style.width=W.width;}}}if(W.height){t.style.height=W.height;}if(W.alignment){var i=Echo.Sync.Alignment.getRenderedHorizontal(W.alignment);var s=typeof(alignment)=="object"?W.alignment.vertical:W.alignment;switch(i){case"center":g.style.margin="0px auto";g.style.cssFloat="none";break;default:g.style.cssFloat=i;break;}var U;switch(s){case"top":U="top";break;case"middle":U="middle";break;case"bottom":U="bottom";break;default:U="";break;}t.style.verticalAlign=U;t.style.textAlign="center";}Echo.Sync.Insets.render(W.insets,g,"padding");Echo.Sync.Color.render(W.background,t,"backgroundColor");Echo.Sync.FillImage.render(W.backgroundImage,t);}if(Echo.Sync.Extent.isPercent(Y.render("height"))){g.style.height="100%";}if(Echo.Sync.Extent.isPercent(Y.render("width"))){g.style.width="100%";}},reloadPositions:function(){M.hDiv.style.top=M.mDiv.offsetHeight+"px";M.bDiv.style.top=I.headerVisible?(M.hDiv.offsetTop+M.hDiv.offsetHeight)+"px":M.hDiv.style.top;M.bDiv.style.bottom=M.pDiv.offsetHeight+"px";}};if(I.colModel){var r=document.createElement("thead");var P=document.createElement("tr");var T=document.createElement("th");for(var K=0;K<I.colModel.length;K++){var k=I.colModel[K];var c=T.cloneNode(false);if(k.id!==null){c.setAttribute("cmid",k.id);if(k.sortable){c.setAttribute("abbr",k.id);}}c.setAttribute("title",k.tooltip);c.hide=k.hide||!k.visible;c.process=k.process;a(c).data({rowDataIndex:K,componentIdx:k.cell.componentIdx,visible:k.visible});P.appendChild(c);}r.appendChild(P);a(F).prepend(r);}var y=document.createElement("div");M.gDiv=y.cloneNode(false);M.mDiv=y.cloneNode(false);M.hDiv=y.cloneNode(false);M.bDiv=y.cloneNode(false);M.vDiv=y.cloneNode(false);M.rDiv=y.cloneNode(false);M.cDrag=y.cloneNode(false);M.block=y.cloneNode(false);M.nDiv=y.cloneNode(false);M.nBtn=y.cloneNode(false);M.iDiv=y.cloneNode(false);M.tDiv=y.cloneNode(false);M.sDiv=y.cloneNode(false);if(I.usepager||I.showPageStat){M.pDiv=y.cloneNode(false);}M.hTable=document.createElement("table");M.hTable.id="HEADER."+I.ownerId;M.gDiv.className="flexigrid";if(a.browser.msie){M.gDiv.className+=" ie";}if(I.novstripe){M.gDiv.className+=" novstripe";}a(F).before(M.gDiv);M.gDiv.appendChild(F);if(I.buttons){M.tDiv.className="tDiv";var S=document.createElement("div");S.className="tDiv2";for(K=0;K<I.buttons.length;K++){var C=I.buttons[K];if(!C.separator){var A=document.createElement("div");A.className="fbutton";A.innerHTML="<div><span>"+C.name+"</span></div>";if(C.bclass){a("span",A).addClass(C.bclass).css({paddingLeft:20});}A.onpress=C.onpress;A.name=C.name;if(C.onpress){a(A).click(function(){this.onpress(this.name,M.gDiv);});}a(S).append(A);if(a.browser.msie&&a.browser.version<7){a(A).hover(function(){a(this).addClass("fbOver");},function(){a(this).removeClass("fbOver");});}}else{a(S).append("<div class='btnseparator'></div>");}}a(M.tDiv).append(S);a(M.tDiv).append("<div style='clear:both'></div>");a(M.gDiv).prepend(M.tDiv);}M.hDiv.className="hDiv";if(!I.headerVisible){M.hDiv.style.visibility="hidden";M.hDiv.style.height="0px";}a(F).before(M.hDiv);M.hTable.cellPadding=0;M.hTable.cellSpacing=0;var N=y.cloneNode(false);N.className="hDivBox";M.hDiv.appendChild(N);N.appendChild(M.hTable);var r=a("thead:first",F)[0];if(r){M.hTable.appendChild(r);}r=null;if(!I.colmodel){var w=0;}a("thead tr:first th",M.hDiv).each(function(){var i=a(this);var s=document.createElement("div");M.renderCell(i.data("componentIdx"),s,this,a(this));var g=i.attr("abbr");if(g){i.click(function(V){if(!a(this).hasClass("thOver")){return false;}var U=(V.target||V.srcElement);if(U.href||U.type){return true;}var t=a("div",this);if(t.hasClass("active")){t.toggleClass("sasc");t.toggleClass("sdesc");}else{t.addClass("active");}M.changeSort(this,V.ctrlKey);});if(I.sortModel&&I.sortModel.columns){for(K=0;K<I.sortModel.columns.length;K++){var p=I.sortModel.columns[K];if(g==p.columnId){i.addClass("sorted");s.className="s"+p.sortOrder;}}}}if(this.hide){i.hide();}if(!I.colmodel){i.attr("axis","col"+w++);}i.empty().append(s).removeAttr("width").mousedown(function(t){M.dragStart("colMove",t,this);}).hover(function(){if(!M.colresize&&!a(this).hasClass("thMove")&&!M.colCopy){a(this).addClass("thOver");}if(a(this).attr("abbr")){var ab=a("div",this);var V=a(this).hasClass("sorted");if(!V&&!M.colCopy&&!M.colresize){ab.addClass("s"+I.sortorder);}else{if(V&&!M.colCopy&&!M.colresize){ab.toggleClass("sasc");ab.toggleClass("sdesc");}}}if(M.colCopy){var W=a("th",M.hDiv).index(this);if(W==M.dcoln){return false;}var X=i.offset();var aa=null;if(W<M.dcoln){aa=a(M.cdropleft);aa.css("left",X.left);}else{aa=a(M.cdropright);aa.css("left",X.left+i.width()-16);}aa.css("top",X.top+(i.height()/2)-8);i.append(aa);M.dcolt=W;}else{if(!M.colresize){var Z=a("th:visible",M.hDiv).index(this);var U=parseInt(a("div:eq("+Z+")",M.cDrag).css("left"));var Y=parseInt(a(M.nBtn).width())+parseInt(a(M.nBtn).css("borderLeftWidth"));var t=U-Y+Math.floor(I.cgwidth/2);a(M.nDiv).hide();a(M.nBtn).hide();a(M.nBtn).css({left:t,top:M.hDiv.offsetTop,height:this.offsetHeight}).show();var ac=parseInt(a(M.nDiv).width());a(M.nDiv).css({top:M.bDiv.offsetTop});if((t+ac)>a(M.gDiv).width()){a(M.nDiv).css("left",U-ac+1);}else{a(M.nDiv).css("left",t);}if(a(this).hasClass("sorted")){a(M.nBtn).addClass("srtd");}else{a(M.nBtn).removeClass("srtd");}}}},function(){a(this).removeClass("thOver");var t=a("div",this);if(!a(t).hasClass("active")){var t=a("div",this);if(!a(this).hasClass("sorted")){t.removeClass("s"+I.sortorder);}else{t.toggleClass("sasc");t.toggleClass("sdesc");}}else{a(t).removeClass("active");}if(M.colCopy){a(M.cdropleft).remove();a(M.cdropright).remove();M.dcolt=null;}});});M.bDiv.className="bDiv";a(F).before(M.bDiv);a(M.bDiv).scroll(function(g){M.scroll();return true;}).append(F);if(I.height=="auto"){a("table",M.bDiv).addClass("autoht");}a("tbody",M.bDiv).hide();var e=a("thead tr:first th:first",M.hDiv)[0];if(e!=null){M.cDrag.className="cDrag";M.cdpad=0;var n=a(e);var H=a("div",e);M.cdpad+=(isNaN(parseInt(H.css("borderLeftWidth")))?0:parseInt(H.css("borderLeftWidth")));M.cdpad+=(isNaN(parseInt(H.css("borderRightWidth")))?0:parseInt(H.css("borderRightWidth")));M.cdpad+=(isNaN(parseInt(H.css("paddingLeft")))?0:parseInt(H.css("paddingLeft")));M.cdpad+=(isNaN(parseInt(H.css("paddingRight")))?0:parseInt(H.css("paddingRight")));M.cdpad+=(isNaN(parseInt(n.css("borderLeftWidth")))?0:parseInt(n.css("borderLeftWidth")));M.cdpad+=(isNaN(parseInt(n.css("borderRightWidth")))?0:parseInt(n.css("borderRightWidth")));M.cdpad+=(isNaN(parseInt(n.css("paddingLeft")))?0:parseInt(n.css("paddingLeft")));M.cdpad+=(isNaN(parseInt(n.css("paddingRight")))?0:parseInt(n.css("paddingRight")));a(M.bDiv).before(M.cDrag);var d=a(M.bDiv).height();var o=a(M.hDiv).height();a(M.cDrag).css({top:-o+"px"});a("thead tr:first th",M.hDiv).each(function(){var g=document.createElement("div");a(M.cDrag).append(g);if(!I.cgwidth){I.cgwidth=a(g).width();}a(g).css({height:d+o}).mousedown(function(i){M.dragStart("colresize",i,this);});if(a.browser.msie&&a.browser.version<7){M.fixHeight(a(M.gDiv).height());a(g).hover(function(){M.fixHeight();a(this).addClass("dragging");},function(){if(!M.colresize){a(this).removeClass("dragging");}});}});}if(I.resizable&&I.height!="auto"){M.vDiv.className="vGrip";a(M.vDiv).mousedown(function(g){M.dragStart("vresize",g);}).html("<span></span>");a(M.bDiv).after(M.vDiv);}if(I.resizable&&I.width!="auto"&&!I.nohresize){M.rDiv.className="hGrip";a(M.rDiv).mousedown(function(g){M.dragStart("vresize",g,true);}).html("<span></span>").css("height",a(M.gDiv).height());if(a.browser.msie&&a.browser.version<7){a(M.rDiv).hover(function(){a(this).addClass("hgOver");},function(){a(this).removeClass("hgOver");});}a(M.gDiv).append(M.rDiv);}if(I.usepager||I.showPageStat){M.pDiv.className="pDiv";M.pDiv.innerHTML='<div class="pDiv2"></div>';a(M.bDiv).after(M.pDiv);if(I.usepager){var O=' <div class="pGroup"> <div class="pFirst pButton"><span></span></div><div class="pPrev pButton"><span></span></div> </div> <div class="btnseparator"></div> <div class="pGroup"><span class="pcontrol">{page} <input type="text" size="4" value="1" /> {of} <span> 1 </span></span></div> <div class="btnseparator"></div> <div class="pGroup"> <div class="pNext pButton"><span></span></div><div class="pLast pButton"><span></span></div> </div>';O=O.replace(/{page}/,I.pageWord);O=O.replace(/{of}/,I.ofWord);a("div",M.pDiv).html(O);a(".pReload",M.pDiv).click(function(){M.populate();});a(".pFirst",M.pDiv).click(function(){M.changePage("first");});a(".pPrev",M.pDiv).click(function(){M.changePage("prev");});a(".pNext",M.pDiv).click(function(){M.changePage("next");});a(".pLast",M.pDiv).click(function(){M.changePage("last");});a(".pcontrol input",M.pDiv).keydown(function(g){if(g.keyCode==13){M.changePage("input");}});if(a.browser.msie&&a.browser.version<7){a(".pButton",M.pDiv).hover(function(){a(this).addClass("pBtnOver");},function(){a(this).removeClass("pBtnOver");});}if(I.useRp){var l="";for(var J=0;J<I.rpOptions.length;J++){if(I.rp==I.rpOptions[J]){v='selected="selected"';}else{v="";}l+="<option value='"+I.rpOptions[J]+"' "+v+" >"+I.rpOptions[J]+"&nbsp;&nbsp;</option>";}a(".pDiv2",M.pDiv).prepend("<div class='pGroup'><select name='rp'>"+l+"</select></div> <div class='btnseparator'></div>");a("select",M.pDiv).change(function(){I.newp=1;I.rp=+this.value;if(I.onRpChange){I.onRpChange.call(I.owner,+this.value);}else{M.populate();}});}}if(I.showPageStat){var B=' <div class="btnseparator"></div> <div class="pGroup"> <div class="pReload pButton"><span></span></div> </div> <div class="btnseparator"></div> <div class="pGroup"><span class="pPageStat"></span></div>';a(".pDiv2",M.pDiv).append(B);a(".pReload",M.pDiv).click(function(){M.populate();});}if(I.searchitems){a(".pDiv2",M.pDiv).prepend("<div class='pGroup'> <div class='pSearch pButton'><span></span></div> </div>  <div class='btnseparator'></div>");a(".pSearch",M.pDiv).click(function(){a(M.sDiv).slideToggle("fast",function(){a(".sDiv:visible input:first",M.gDiv).trigger("focus");});});M.sDiv.className="sDiv";var E=I.searchitems;var x="";for(var G=0;G<E.length;G++){if(I.qtype==""&&E[G].isdefault==true){I.qtype=E[G].name;var v='selected="selected"';}else{v="";}x+="<option value='"+E[G].name+"' "+v+" >"+E[G].display+"&nbsp;&nbsp;</option>";}if(I.qtype==""){I.qtype=E[0].name;}a(M.sDiv).append("<div class='sDiv2'>Quick Search <input type='text' size='30' name='q' class='qsbox' /> <select name='qtype'>"+x+"</select> <input type='button' value='Clear' /></div>");a("input[name=q],select[name=qtype]",M.sDiv).keydown(function(g){if(g.keyCode==13){M.doSearch();}});a("input[value=Clear]",M.sDiv).click(function(){a("input[name=q]",M.sDiv).val("");I.query="";M.doSearch();});a(M.bDiv).after(M.sDiv);}}a(M.pDiv,M.sDiv).append("<div style='clear:both'></div>");if(I.title){M.mDiv.className="mDiv";M.mDiv.innerHTML='<div class="ftitle">'+I.title+"</div>";a(M.gDiv).prepend(M.mDiv);if(I.showTableToggleBtn){a(M.mDiv).append('<div class="ptogtitle" title="'+I.mintablemsg+'"><span></span></div>');a("div.ptogtitle",M.mDiv).click(function(){a(M.hDiv).toggle();a(M.bDiv).toggle();a(M.pDiv).toggle();a(M.gDiv).toggleClass("hideBody");a(this).toggleClass("vsble");});}}M.cdropleft=document.createElement("span");M.cdropleft.className="cdropleft";M.cdropright=document.createElement("span");M.cdropright.className="cdropright";M.block.className="gBlock";var j=a(M.bDiv).height();var m=M.bDiv.offsetTop;a(M.block).css({width:M.bDiv.style.width,height:j,background:"white",position:"relative",marginBottom:(j*-1),zIndex:1,top:m,left:"0px"});a(M.block).fadeTo(0,I.blockOpacity);if(a("th",M.hDiv).length){M.nDiv.className="nDiv";M.nDiv.innerHTML="<table cellpadding='0' cellspacing='0'><tbody></tbody></table>";a(M.nDiv).css({marginBottom:(j*-1),display:"none",top:m}).noSelect();a("th div",M.hDiv).each(function(i){var p=a("th[axis='col"+i+"']",M.hDiv);var g='checked = "checked"';if(p.css("display")=="none"){g="";}var s=document.createElement("tr");if(!p.data("visible")){a(s).css("display","none");}a("tbody",M.nDiv).append(s);a(s).append('<td class="ndcol1"><input type="checkbox" '+g+' class="togCol" value="'+i+'" /></td><td class="ndcol2">'+p.html()+"</td>");});if(a.browser.msie&&a.browser.version<7){a("tr",M.nDiv).hover(function(){a(this).addClass("ndcolover");},function(){a(this).removeClass("ndcolover");});}a("td.ndcol2",M.nDiv).click(function(){if(a("input:checked",M.nDiv).length<=I.minColToggle&&a(this).prev().find("input")[0].checked){return false;}return M.toggleCol(a(this).prev().find("input").val());});a("input.togCol",M.nDiv).click(function(){if(a("input:checked",M.nDiv).length<I.minColToggle&&!this.checked){return false;}a(this).parent().next().trigger("click");});a(M.gDiv).prepend(M.nDiv);a(M.nBtn).addClass("nBtn").html("<div></div>").attr("title",I.hidecolmsg).click(function(){a(M.nDiv).fadeToggle("fast");return true;});if(I.showToggleBtn){a(M.gDiv).prepend(M.nBtn);}}a(M.iDiv).addClass("iDiv").css({display:"none"});a(M.bDiv).append(M.iDiv);a(M.bDiv).hover(function(){a(M.nDiv).hide();a(M.nBtn).hide();},function(){if(M.multisel){M.multisel=false;}});a(M.gDiv).hover(function(){},function(){a(M.nDiv).hide();a(M.nBtn).hide();});a(document).mousemove(q).mouseup(D).mouseenter(Q).mouseleave(f);function q(g){M.dragMove(g);}function D(){M.dragEnd();}function Q(){}function f(){M.dragEnd();}M.cleanup=function(){a(document).unbind("mousemove",q).unbind("mouseup",D).unbind("mouseenter",Q).unbind("mouseleave",f);a(F.grid.gDiv).remove();I.onToggleCol=null;I.onChangeSort=null;I.preProcess=null;I.onSuccess=null;I.onChangePage=null;I.onSubmit=null;I.onPopulateCallback=null;I.onDragCol=null;I.onResizeCol=null;I.onResizeGrid=null;I=null;M=null;F.grid=null;F.p=null;F=null;};M.focus=function(g){if(this.loading){M.lazyFocus=M.focus;}else{M.lazyFocus=null;if(!a("table tbody tr").hasClass("trSelected")){if(g){}else{a("table tbody tr").removeClass("trSelected");}}}};M.remoteControl=function(s){if(M.selectedRow&&M.selectedRow!=null){var i=s.keyCode;if(s.keyCode==13){M.selectedRow.trigger("click");}else{if(s.keyCode==40){var p=M.selectedRow.next();if(p.is("tr")){M.processSelection(p,s);var t=0;p.prevAll().each(function(){t+=a(this).height();});if(a(M.bDiv).height()/2.3<t){M.bDiv.scrollTop=M.bDiv.scrollTop+p.height();}}}else{if(s.keyCode==38){var g=M.selectedRow.prev();if(g.is("tr")){M.processSelection(g,s);var t=0;g.nextAll().each(function(){t+=a(this).height();});if(a(M.bDiv).height()/2.3<t){M.bDiv.scrollTop=M.bDiv.scrollTop-g.height();}}}else{if(s.keyCode==39){M.bDiv.scrollLeft=M.bDiv.scrollLeft+50;M.scroll();}else{if(s.keyCode==37){M.bDiv.scrollLeft=M.bDiv.scrollLeft-50;M.scroll();}}}}}}return true;};M.multiSort=function(p,U,aa){var Z=p.columns;var W=new Array();for(Y=0;Y<Z.length;Y++){var ab=Z[Y];for(var g=0;g<U.columns.length;g++){if(U.columns[g].id==ab.columnId){W.push(new Object({index:g,order:ab.sortOrder}));}}}W.reverse();var X=new Array();for(var Y=0;Y<aa.pages.length;Y++){X=X.concat(aa.pages[Y].rows);}var V=new RegExp("[\\"+I.digitGroupDL+"]","g");var i=new RegExp("[\\"+I.decimalDelimiter+"]","g");X=t(W,X);var s=aa.pages[0];s.rows=X;return aa;function t(ad,ah){for(Y=0;Y<ad.length;Y++){var af=ad[Y].index;var ae=ad[Y].order;ah.sort(ag);}return ah;function ag(an,am){var ak=I.owner.component.getComponent(an.cells[af].componentIdx).get("text");var aj=I.owner.component.getComponent(am.cells[af].componentIdx).get("text");if(!ak&&!aj){return 0;}else{if(!ak&&aj){return -1;}else{if(ak&&!aj){return 1;}}}var ai;if(ac(ak)&&ac(aj)){if(typeof ak!="number"){var ao=ak.replace(V,"");}if(typeof(ao)!="undefined"){ao=(+ao.replace(i,"."));}if(typeof aj!="number"){var al=aj.replace(V,"");}if(typeof(al)!="undefined"){al=al.replace(i,".");}ai=ae=="asc"?ao-al:al-ao;}else{if(ak==aj){ai=0;}if(ae=="asc"){ai=(ak<aj)?-1:1;}else{ai=(ak>aj)?-1:1;}}return ai;}function ac(aj){if(typeof aj=="number"){return true;}var al="\\"+I.digitGroupDL;var ai="\\"+I.decimalDelimiter;var ak="(^([-+]?[\\d"+al+ai+"]*)$)";return RegExp(ak).test(a.trim(aj));}}};M.reload=function(){M.loading=false;M.populate();};if(a.browser.msie&&a.browser.version<7){a(".hDiv,.bDiv,.mDiv,.pDiv,.vGrip,.tDiv, .sDiv",M.gDiv).css({width:"100%"});a(M.gDiv).addClass("ie6");if(I.width!="auto"){a(M.gDiv).addClass("ie6fullwidthbug");}}F.p=I;F.grid=M;if(I.url&&I.autoload){M.populate();}else{M.setBusy(true);function z(){M.setBusy(false);a("tbody",M.bDiv).show();}var R=a("thead tr:first th",M.hDiv);var L=a("tbody tr",M.bDiv);var b=0;function h(){if(b<L.length){var s=L[b];if(s){var p=a(s);var g=0;a("td",s).each(function(){var i=false;if(R.length>g){i=R[g]||false;}M.addCellProp(this,s,this.innerHTML,i);g++;});M.addRowProp(p);b++;setTimeout(h,1);}else{z();}}else{z();}}setTimeout(h,1);}M.reloadPositions();return F;};a.fn.flexigrid=function(b){return this.each(function(){a.addFlex(this,b);});};a.fn.flexReload=function(b){return this.each(function(){if(this.grid){return this.grid.reload();}});};a.fn.flexOptions=function(b){return this.each(function(){if(this.grid){a.extend(this.p,b);}});};a.fn.flexToggleCol=function(c,b){return this.each(function(){if(this.grid){this.grid.toggleCol(c,b);}});};a.fn.flexAddData=function(b){return this.each(function(){if(this.grid){this.grid.setBusy(true);this.grid.addData(b);}});};a.fn.noSelect=function(c){if(c==null){var b=true;}else{b=c;}if(b){return this.each(function(){if(a.browser.msie||a.browser.safari){a(this).bind("selectstart",function(){return false;});}else{if(a.browser.mozilla){a(this).css("MozUserSelect","none");a("body").trigger("focus");}else{if(a.browser.opera){a(this).bind("mousedown",function(){return false;});}else{a(this).attr("unselectable","on");}}}});}else{return this.each(function(){if(a.browser.msie||a.browser.safari){a(this).unbind("selectstart");}else{if(a.browser.mozilla){a(this).css("MozUserSelect","inherit");}else{if(a.browser.opera){a(this).unbind("mousedown");}else{a(this).removeAttr("unselectable","on");}}}});}};a.fn.flexDestroy=function(){return this.each(function(){if(this.grid){this.grid.cleanup();}});};a.fn.flexMultiSort=function(c,b,d){return this.each(function(){if(this.grid){this.grid.multiSort(c,b,d);}});};a.fn.flexFocus=function(b){return this.each(function(){if(this.grid){this.grid.focus(b);}});};a.fn.flexFixHeight=function(){return this.each(function(){if(this.grid){this.grid.fixHeight();}});};a.fn.flexRemoteControl=function(b){return this.each(function(){if(this.grid){this.grid.remoteControl(b);}});};a.fn.flexCheckSelection=function(){return this.each(function(){if(this.grid){this.grid.notifyForSelection();}});};a.fn.flexMakeSelection=function(b){return this.each(function(){if(this.grid){this.grid.makeSelection(b);}});};a.fn.flexGetCounterIndexes=function(){var c=[];var h=this[0].p;var e=this[0].grid;if(e){var d=a("th[cmid='-1']",e.hDiv);if(d[0]){c[0]=/(\d*)$/.exec(d.attr("id"))[0]*1;var b=d.index();var f=a("#"+a.fn.fixID(h.ownerId+".DATA")).children("tr");f.each(function(g,i){c[g+1]=/(\d*)$/.exec(a(i).children()[b].id)[0]*1;});}}return c;};a.fn.flexRenderChilds=function(b){return this.each(function(){if(this.grid){this.grid.setBusy(true);var d=0;var c=Core.Web.Scheduler.run(Core.method(this,function(){var h=50;while(h>0&&d<b.length){var f=b[d];var e=document.getElementById(f);var g=document.createElement("div");this.grid.renderCell(/(\d*)$/.exec(f)[0]*1,g,e);a(e).empty().append(g);d++;h--;}if(d==b.length){Core.Web.Scheduler.remove(c);this.grid.setBusy(false);this.grid.reloadPositions();}}),1,true);}});};a.fn.flexRenderLayoutChilds=function(b){return this.each(function(){if(this.grid){this.grid.setBusy(true);var d=0;var c=Core.Web.Scheduler.run(Core.method(this,function(){var g=50;while(g>0&&d<b.length){var f=b[d];var e=document.getElementById(f);this.grid.renderCellLayoutData(/(\d*)$/.exec(f)[0]*1,e.firstChild,e);d++;g--;}if(d==b.length){Core.Web.Scheduler.remove(c);this.grid.setBusy(false);this.grid.reloadPositions();this.grid.rePosDrag();}}),1,true);}});};a.fn.flexUpdateColumns=function(b){return this.each(function(){if(this.grid){var d=this.grid;var j=function(k,l){var m=a(a("td.ndcol2",d.nDiv)[k.index()]);var g=m.prev().find("input")[0].checked;if(g==l){m.trigger("click");}};for(u=0;u<b.length;u++){var c=a("th[cmid='"+b[u].ID+"']",d.hDiv);for(var h=0;h<b[u].props.length;h++){var f=b[u].props[h][0];var i=b[u].props[h][1];switch(f){case exxcellent.FlexiGrid.COL_UPDATE_TOOLTIP:c.attr("title",i);break;case exxcellent.FlexiGrid.COL_UPDATE_SORTABLE:break;case exxcellent.FlexiGrid.COL_UPDATE_HIDED:j(c,i);break;case exxcellent.FlexiGrid.COL_UPDATE_VISIBLE:j(c,!i);var e=a(a("td.ndcol2",d.nDiv)[c.index()]).parent();if(i){e.css("display","");}else{e.css("display","none");}break;default:throw new Error("Unsupported column update property: "+f);break;}}}this.grid.reloadPositions();}});};a.fn.fixID=function(b){return b.replace(/(:|\.)/g,"\\$1");};a.fn.unselectable=function(){return this.each(function(){a(this).css("-moz-user-select","none").css("-khtml-user-select","none").css("user-select","none");if(a.browser.msie){a(this).each(function(){this.ondrag=function(){return false;};});a(this).each(function(){this.onselectstart=function(){return(false);};});}else{if(a.browser.opera){a(this).attr("unselectable","on");}}});};})(jQuery);